# **判断一个对象是否为空：是否包含原型链上的自定义属性或方法？**

## 前言

在 JavaScript 中，判断一个对象是否“为空”并不只是检查它本身是否有属性。有些业务场景下，我们还需要判断它的原型链上是否包含自定义的属性或方法。例如，在实现深拷贝、缓存管理、配置合并等功能时，这种判定尤为关键。本文将全面解析：如何判断一个对象是否“完全为空”，即既没有自身属性，也没有原型链上的自定义属性或方法。

## 什么是“空对象”？

一般来说，一个“空对象”指的是没有任何自身可枚举属性的对象。例如：

```plain
const obj = {};
```

但如果考虑原型链，例如：

```plain
const obj = {};
console.log(obj.toString); // [Function: toString]
```

`toString` 并不是 `obj` 自己的属性，而是来自 `Object.prototype` 的。这说明对象的属性访问并不局限于自身，还可能涉及原型链。

那么问题来了：如果原型链上存在自定义属性，我们是否应该将其视为“非空”？这取决于业务需要。如果我们要判断“对象完全干净”，就必须分析它的原型链。

## 如何判断对象自身是否为空？

最常见的方法是：

```plain
Object.keys(obj).length === 0
```

也可以使用：

```plain
JSON.stringify(obj) === '{}'
```

或者：

```plain
Object.getOwnPropertyNames(obj).length === 0
```

这些方法都只检查对象自身的属性，不会涉及原型链。

## 如何检查原型链是否有自定义属性？

原型链上的属性包括了继承而来的方法和字段。我们需要递归地遍历对象的原型链，每一层都进行属性检查。

示例代码如下：

```plain
function isCompletelyEmpty(obj) {
  let current = obj;

  while (current !== null) {
    if (Object.getOwnPropertyNames(current).length > 0) {
      return false;
    }
    current = Object.getPrototypeOf(current);
  }

  return true;
}
```

这个函数会沿着原型链一路检查下去，直到 `null` 为止。如果任何一层对象拥有自定义属性（包括不可枚举属性），就认为对象“非空”。

不过注意，这种方法会把 `Object.prototype` 自带的属性也考虑进去。如果只关心“用户定义”的原型，可以加以过滤。

## 应对特殊对象

对于 `Object.create(null)` 创建的对象，它没有原型：

```plain
const pure = Object.create(null);
console.log(Object.getPrototypeOf(pure)); // null
```

这种对象天然没有原型链，更容易判断是否为空。

------

## 面试回答示范

**问题：如何判断一个对象是否为空（包含对原型链的判断）？**

回答示例：

“如果只判断对象自身是否为空，可以使用 `Object.keys(obj).length === 0` 或 `Object.getOwnPropertyNames(obj).length === 0`。

但如果还需要判断原型链是否有自定义属性，可以使用循环或递归方式，逐层检查每一层原型对象是否有属性存在。例如：

```plain
function isCompletelyEmpty(obj) {
  let current = obj;
  while (current !== null) {
    if (Object.getOwnPropertyNames(current).length > 0) return false;
    current = Object.getPrototypeOf(current);
  }
  return true;
}
```

这段代码会判断对象自身以及所有原型链层级是否都无自定义属性。”

------

## 总结

判断一个对象是否为空，不应仅限于它自身的属性。在某些安全敏感或架构严谨的场景中，原型链上的自定义属性也必须纳入考察。通过逐层遍历原型链并检查每一层是否含有自定义字段，我们才能更准确地评估一个对象是否“完全为空”。理解这一点，对于编写更健壮、可维护的 JavaScript 代码非常关键。